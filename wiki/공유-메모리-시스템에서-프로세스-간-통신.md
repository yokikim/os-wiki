[[공유 메모리]]

***

- 공유 메모리의 사용
    
    공유 메모리를 사용하는 프로세스 간 통신에서는 통신하는 프로세스들이 공유 메모리 영역을 구축해야 한다.
    
    통상 공유 메모리 영역은 공유 메모리 세그먼트를 생성하는 프로세스의 주소 공간에 위치한다.
    
    이 공유 메모리 세그먼트를 이용하여 통신하고자 하는 다른 프로세스들은 이 세그먼트를 자신의 주소 공간에 추가하여야 한다.
    
    일반적으로 운영체제는 한 프로세스가 다른 프로세스의 메모리에 접근하는 것을 금지한다는 것을 기억하자.
    
    공유 메모리는 둘 이상의 프로세스가 이 제약 조건을 제거하는 것에 동의하는 것을 필요로 한다.
    
    그런 후에 프로세스들은 공유 영역에 읽고 씀으로써 정보를 교환할 수 있다.
    
    데이터의 형식과 위치는 이들 프로세스에 의해 결정되며 운영체제의 소관이 아니다.
    
    또한 프로세스들은 동시에 동일한 위치에 쓰지 않도록 책임져야 한다.
    
- 생산자와 소비자
    
    협력하는 프로세스의 개념을 설명하기 위해서, 협력하는 프로세스의 일반적인 패러다임인 생상자-소비자 문제를 생각해 보기로 하자.
    
    생산자 프로세스는 성보를 생산하고 소비자 프로세스는 정보를 소비한다.
    
    예를 들어, 컴파일러는 어셈블리 코드를 생산하고, 어셈블러는 이것을 소비한다.
    
    어셈블러는 이어 목적 모듈object module을 생산할 수 있고, 적재기loader는 이들을 소비한다.
    
    생산자 소비자 문제는 클라이언트 서버 패러다임을 위한 유용한 은유를 제공한다.
    
    일반적으로 우리는 서버를 생산자로 클라이언트를 소비자로 생각한다. 예를 들면 웹 서버는 HTML 파일과 이미지와 같은 웹 콘텐츠를 생산하고(즉, 제공하고) 이 자원들을 요청한 클라이언트 웹 브라우저가 소비하게 된다.(즉, 읽는다.)
    
- 생산자 소비자의 버퍼 사용
    
    생산자-소비자 문제의 하나의 해결책은 공유 메모리를 사용하는 것이다.
    
    생산자와 소비자 프로세스들이 병행으로 실행되도록 하려면, 생산자가 정보를 채워 넣고 소비자가 소모할 수 있는 항목들의 버퍼가 반드시 사용 가능해야 한다.
    
    이 버퍼는 생산자와 소비자가 공유하는 메모리 영역에 존재하게 된다.
    
    생산자가 한 항목을 생산하고, 그동안에 소비자는 다른 항목을 소비할 수 있다.
    
    생산자와 소비자가 반드시 동기화되어야 생산되지도 않은 항목들을 소비자가 소비하려고 시도하지 않을 것이다.
    
- 버퍼의 유형
    
    두 가지 유형의 버퍼가 사용된다.
    
    무한 버퍼unbounded buffer의 생산자 소비자 문제에서는 버퍼의 크기에 실질적인 한계가 없다.
    
    소비자는 새로운 항목을 기다려야만 할 수도 있지만, 생산자는 항상 새로운 항목을 생산할 수 있다.
    
    유한버퍼 bounded buffer는 버퍼의 크기가 고정되어 있다고 가정한다.
    
    이 경우 버퍼가 비어 있으면 소비자는 반드시 대기해야 하며, 모든 버퍼가 채워져 있으면 생산자가 대기해야 한다.