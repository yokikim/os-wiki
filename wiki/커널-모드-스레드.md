---

layout: page
title: 커널 모드 스레드
parent: 커널,커널-모드,커널-스레드

---

***

923p

프로그래머가 전통적인 Windows에서 스레드로 생각하는 것은 실제로 사용자 모드 스레드(UT)와 커 널 모드 스레드(KT)의 두 가지 실행 모드가 있는 스레드이다. 스레드에는 UT 실행을 위한 스택과 KT를 위한 스택이 있다. UT는 커널 모드로 트랩하게 만드는 명령을 실행하여 시스템 서비스를 요청한다. 커널 층은 트랩 핸들러를 실행하고 이 핸들 러는 UT 스택을 상응하는 KT 스택으로 전환하고 CPU 모드를 커널로 변경한다. KT 모드의 스레드가 커널 실행을 완료하고 상응하는 UT로 다시 전환할 준비가 되면 커널층이 호출되어 UT로 전환되고 시용자 모드에서 계속 실행한다. KT 전환은 인터럽트가 발생할 때도 일어난다.
Windows 7은 커널 층의 동작을 수정하여 UT의 사용자 모드 스케줄링을 지원한다. Windows 7의 사용자 모드 스케줄러는 협조적 스케줄링을 지원한다. UT는 사용자 모드 스케줄러를 호출하여 다른 UT에 명시적으로 양보할 수 있다. 커널로 진입할 필요가 없다. 사용자 모드 스케줄링은 21.7.3.7에 자세히 설명되어 있다.
Windows에서 디스패처는 커널에서 실행되는 별도의 스레드가 아니다. 대신 디스패처 코드는 UT 스레드의 KT 구성요소에 의해 실행된다. 다른 운영체제에서 커널 스레드가 호출되는 동일한 상황에서 스레드는 커널 모드로 진입한다. 현재 코어에서 다음에 실행될 스레드를 결정하는 작업과 같은 다른 작업을 한 후에도 역시 KT가 디스패처 코드를 실행하게 만든다.
