176p

전통적인 프로세스는 하나의 제어 [스레드](스레드.html)를 가지고 있다.

만일 [프로세스]가 다수의 제어 스레드를 가진다면 프로세스는 동시에 하나 이상의 작업을 수행할 수 있다.

![image](https://user-images.githubusercontent.com/116250393/211206105-1361a50b-cc61-431e-ac88-b7d5a884817e.png)

해당 그림은 전통적인 [단일 스레드] [프로세스]와 [다중 스레드] [프로세스](단일 스레드] [프로세스]와 [다중 스레드] [프로세스.html)의 차이점을 보여주고 있다.

***

# 동기 Motivation

현대의 컴퓨터와 모바일 기기에서 작동하는 거의 모든 소프트웨어 응용들은 다중 스레드를 이용한다.

하나의 응용은 몇 개의 실행 흐름을 가진 독립적인 프로세스로 구현된다.

아래에서는 다중 스레드 응용 프로그램의 몇 가지 예를 보여준다.

> * 이미지 모음에서 사진 축소판을 만드는 응용 프로그램은 별도의 스레드를 사용하여 개별 이미지에서 축소판을 생성할 수 있다.
> * 웹 브라우저는 하나의 스레드가 이미지 또는 텍스트를 표시하고 다른 스레드는 네트워크에서 데이터를 검색하도록 할 수 있다.
> * 워드 프로세서에는 그래픽을 표시하는 스레드, 사용자의 키 입력에 응답하는 또 다른 스레드 및 백그라운드에서 맞춤법 및 문법 검사를 수행하는 세 번째 스레드가 있을 수 있다.

응용은 다중 코어 시스템에서 처리 능력을 향상시키도록 설계될 수 있다. 

이러한 응용은 다중 계산 코어를 사용하여 다수의 CPU-집중 작업을 병렬로 처리할 수 있다.

하나의 응용 프로그램이 여러 개의 비슷한 작업을 수행할 필요가 있는 상황들이 또한 있다. 

> * 예를들어, 웹 서버는클라이언트로부터 웹 페이지나 이미지, 소리 등에 대한 요청을 받는다. 
> * 하나의 분주한 웹 서버는 여러 개(아마도 수천 개)의 클라이언트들이 병행하게 접근할 수 있다. 
> * 만약 웹 서버가 전통적인 단일 스레드 프로세스로 작동한다면, 자신의 단일 프로세스로 한 번에 하나의 클라이언트만 서비스할 수 있게 되어 클라이언트는 자신의 요구가 서비스되기까지 매우 긴 시간을 기다려야 한다.
> > * 하나의 해결책은 서버가 요청을 받아들이는 하나의 프로세스로 동작하게 하는 것이다. 
> > * 즉, 서버에게 서비스 요청이 들어오면, 프로세스는 그 요청을 수행할 별도의 프로세스를 생성하는 것이다. 

사실 이와 같은 방식으로 프로세스를 생성하는 것은 스레드가 대중화되기 전에는 매우 보편적이었다.

**앞장에서도 논의했던 것처럼 프로세스 생성 작업은 매우 많은 시간을 소비하고 많은 자원을 필요로 하는 일이다.**

**하지만 새 프로세스가 해야 할 일이 기존 프로세스가 하는 일과 동일하다면 왜 이 많은 오버헤드를 감수해야 하는가?** 

대부분은 그렇게 하는 것보다는 프로세스 안에 여러 스래드를 만들어 나가는 것이 더 효율적이다. 

> * 웹 서버가 다중 스레드화 되면, 서버는 클라이언트의 요청을 listen 하는 별도의 스레드를 생성한다. 
> * 요청이 들어오면 다른 프로세스를 생성하는 것이 아니라, 요청을 서비스할 새로운 스레드를 생성하고 추가적인 요청을 listen 하기 위한 작업을 재개한다. 

![image](https://user-images.githubusercontent.com/116250393/212710971-38487821-82f2-45ed-851f-dcd1a219d6f0.png)

대부분의 운영체제 커널도 일반적으로 다중 스레드이다.

예를 들어 Linux 시스템에서 시스템을 부트하는 동안 여러 커널 스레드가 생성된다. 

각 스레드는 장치 관리, 메모리 관리 또는 인터럽트 처리와 같은 특정 작업을 수행한다. 

ps -ef 명령을 시용하여 실행중인 Linux 시스템에서 커널 스레드를 표시할 수 있다. 

이 명령의 출력을 검사하면 커널스레드 kthreadd (pid = 2)가 표시되며 다른 모든 커널 스레드의 부모 역할을 한다.

많은 응용 프로그램도 기본 정렬, 트리 및 그래프 알고리즘을 포함하여 다중 스레드를 활용할 수 있다. 

또한, 데이터 마이닝, 그래픽 및 인공지능에서 CPU 중심의 최신 문제를 해결해야 하는 프로그래머는 병렬로 실행되는 솔루션을 설계하여 최신 다중 코어 시스템의 성능을 활용할 수 있다.

[다중 스레드 프로그래밍의 장점]

# 다중 스레드 모델

182p

[사용자 스레드](사용자 스레드.html)

[커널 스레드](커널 스레드.html)